let marketCaps={bitcoin:0,ethereum:0,solana:0,polkadot:0,litecoin:0,zcash:0,bittensor:0,kaspa:0,gold:158e11},currentNockPrice=0,currentNockMarketCap=0,circulatingSupply=0,maxSupply=0,selectedMarketCap="bitcoin",price24hChange=0;const formatNumber=e=>e&&0!==e?e>=1e12?`$${(e/1e12).toFixed(2)}T`:e>=1e9?`$${(e/1e9).toFixed(2)}B`:e>=1e6?`$${(e/1e6).toFixed(2)}M`:e>=1e3?`$${(e/1e3).toFixed(2)}K`:e>=1?`$${e.toFixed(2)}`:`$${e.toFixed(6)}`:"—",formatSupply=e=>e&&0!==e?e>=1e12?`${(e/1e12).toFixed(2)}T`:e>=1e9?`${(e/1e9).toFixed(2)}B`:e>=1e6?`${(e/1e6).toFixed(2)}M`:e>=1e3?`${(e/1e3).toFixed(2)}K`:e.toLocaleString():"—",formatPrice=e=>e&&0!==e?e>=1e3?`$${e.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})}`:e>=1?`$${e.toFixed(2)}`:e>=.01?`$${e.toFixed(4)}`:e>=1e-4?`$${e.toFixed(6)}`:`$${e.toFixed(8)}`:"—",formatMultiplier=e=>e&&isFinite(e)?e>=1e6?`${(e/1e6).toFixed(1)}M×`:e>=1e3?`${(e/1e3).toFixed(1)}K×`:`${e.toFixed(0)}×`:"—",formatGains=e=>{if(!e||0===e)return"—";const t=formatNumber(Math.abs(e));return e>=0?`+${t}`:`-${t}`};async function fetchMarketCaps(){try{let e="/api/market-data";"localhost"===window.location.hostname&&(e="http://localhost:3000/api/market-data");const t=await fetch(e),o=await t.json();marketCaps={...marketCaps,...o.marketCaps},currentNockPrice=o.nock.price||0,currentNockMarketCap=o.nock.marketCap||0,circulatingSupply=o.nock.circulatingSupply||0,maxSupply=o.nock.maxSupply||0,price24hChange=o.nock.priceChange24h||0,document.getElementById("currentPriceDisplay").textContent=formatPrice(currentNockPrice),document.getElementById("tickerPrice").textContent=formatPrice(currentNockPrice),document.getElementById("tickerMarketCap").textContent=formatNumber(currentNockMarketCap),document.getElementById("tickerCirculating").textContent=formatSupply(circulatingSupply),document.getElementById("tickerMaxSupply").textContent=formatSupply(maxSupply);const n=document.getElementById("ticker24hChange");0!==price24hChange?(n.textContent=`${price24hChange>=0?"+":""}${price24hChange.toFixed(2)}%`,n.className="ticker-change "+(price24hChange>=0?"positive":"negative")):(n.textContent="0.00%",n.className="ticker-change"),updateHypotheticalPrice()}catch(e){console.error("Error fetching market data:",e),document.getElementById("currentPriceDisplay").textContent="—",document.getElementById("tickerPrice").textContent="—",document.getElementById("tickerMarketCap").textContent="—",document.getElementById("tickerCirculating").textContent="—",document.getElementById("tickerMaxSupply").textContent="—",document.getElementById("ticker24hChange").textContent="—"}}function updateHypotheticalPrice(){const e=maxSupply||circulatingSupply||1e9,t=marketCaps[selectedMarketCap];if(document.getElementById("selectedAssetName").textContent={bitcoin:"Bitcoin's",ethereum:"Ethereum's",solana:"Solana's",polkadot:"Polkadot's",litecoin:"Litecoin's",zcash:"Zcash's",bittensor:"Bittensor's",kaspa:"Kaspa's",gold:"Gold's"}[selectedMarketCap],document.getElementById("selectedMarketCap").textContent=formatNumber(t),e>0&&t>0){const o=t/e;if(document.getElementById("hypotheticalPrice").textContent=formatPrice(o),currentNockPrice>0){const e=o/currentNockPrice;document.getElementById("priceMultiplier").textContent=formatMultiplier(e)}}calculatePortfolio()}function calculatePortfolio(){const e=parseFloat(document.getElementById("userNocks").value)||0,t=maxSupply||circulatingSupply||1e9,o=marketCaps[selectedMarketCap],n=document.getElementById("currentPortfolioBox"),c=document.getElementById("futurePortfolioBox");if(e>0){const a=e*currentNockPrice,r=e*(o/t);document.getElementById("currentPortfolioValue").textContent=formatNumber(a),document.getElementById("futurePortfolioValue").textContent=formatNumber(r),n.classList.add("visible"),c.classList.add("visible")}else n.classList.remove("visible"),c.classList.remove("visible"),document.getElementById("currentPortfolioValue").textContent="—",document.getElementById("futurePortfolioValue").textContent="—"}document.getElementById("marketCapSelector").addEventListener("change",e=>{selectedMarketCap=e.target.value,updateHypotheticalPrice()}),document.getElementById("userNocks").addEventListener("input",calculatePortfolio),fetchMarketCaps(),setInterval(fetchMarketCaps,3e5);